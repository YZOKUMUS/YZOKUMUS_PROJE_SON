<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>404 Error Diagnostic Tool</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .check-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ccc;
        }
        .check-item.success {
            border-left-color: #10b981;
        }
        .check-item.error {
            border-left-color: #ef4444;
        }
        .check-item.warning {
            border-left-color: #f59e0b;
        }
        h1 { color: #1a1a2e; }
        h2 { color: #64748b; margin-top: 30px; }
        .status { font-weight: bold; margin-left: 10px; }
        .success .status { color: #10b981; }
        .error .status { color: #ef4444; }
        .warning .status { color: #f59e0b; }
        code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
        #results { margin-top: 20px; }
        button {
            background: #9d8aff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover { background: #8b7aff; }
        .console-output {
            background: #1a1a2e;
            color: #10b981;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>üîç 404 Error Diagnostic Tool</h1>
    <p>This tool will check all resources referenced in your application and identify any 404 errors.</p>
    
    <button onclick="runDiagnostics()">Run Full Diagnostic</button>
    <button onclick="checkServiceWorker()">Check Service Worker Cache</button>
    <button onclick="clearCache()">Clear All Caches</button>
    
    <div id="results"></div>
    <div id="console-output" class="console-output" style="display:none;"></div>

    <script>
        const resourcesToCheck = [
            // HTML/CSS
            { name: 'Main Stylesheet', path: 'style.css', type: 'css' },
            { name: 'Manifest', path: 'manifest.json', type: 'json' },
            
            // JavaScript Files
            { name: 'Config', path: 'js/config.js', type: 'js' },
            { name: 'Constants', path: 'js/constants.js', type: 'js' },
            { name: 'Utils', path: 'js/utils.js', type: 'js' },
            { name: 'Firebase Config', path: 'js/firebase-config.js', type: 'js' },
            { name: 'Firebase Init', path: 'js/firebase-init.js', type: 'js' },
            { name: 'Auth', path: 'js/auth.js', type: 'js' },
            { name: 'API Service', path: 'js/api-service.js', type: 'js' },
            { name: 'Data Loader', path: 'js/data-loader.js', type: 'js' },
            { name: 'Points Manager', path: 'js/points-manager.js', type: 'js' },
            { name: 'Leaderboard', path: 'js/leaderboard.js', type: 'js' },
            { name: 'Notifications', path: 'js/notifications.js', type: 'js' },
            { name: 'Charts', path: 'js/charts.js', type: 'js' },
            { name: 'Game Core', path: 'js/game-core.js', type: 'js' },
            { name: 'Pronunciation Fix', path: 'js/pronunciation-fix.js', type: 'js' },
            
            // Assets
            { name: 'Icon 512', path: 'ASSETS/badges/icon-512.png', type: 'image' },
            { name: 'Game Icon - Kelime √áevir', path: 'ASSETS/game-icons/kelime-cevir.png', type: 'image' },
            { name: 'Game Icon - Dinle Bul', path: 'ASSETS/game-icons/dinle-bul.png', type: 'image' },
            { name: 'Game Icon - Ayet Oku', path: 'ASSETS/game-icons/ayet-oku.png', type: 'image' },
            { name: 'Game Icon - Dua Et', path: 'ASSETS/game-icons/dua-et.png', type: 'image' },
            { name: 'Game Icon - Hadis Oku', path: 'ASSETS/game-icons/hadis-oku.png', type: 'image' },
            { name: 'Elifba - Harf Tablosu', path: 'ASSETS/elifba-cover/harf-tablosu-icon.png', type: 'image' },
            { name: 'Elifba - √úst√ºn', path: 'ASSETS/elifba-cover/√ºst√ºn-icon.png', type: 'image' },
            { name: 'Elifba - Esre', path: 'ASSETS/elifba-cover/esre-icon.png', type: 'image' },
            { name: 'Elifba - √ñtre', path: 'ASSETS/elifba-cover/otre-icon.png', type: 'image' },
            { name: 'Elifba - Sedde', path: 'ASSETS/elifba-cover/sedde-icon.png', type: 'image' },
            { name: 'Elifba - Cezm', path: 'ASSETS/elifba-cover/cezm-icon.png', type: 'image' },
            { name: 'Elifba - Tenvin', path: 'ASSETS/elifba-cover/tenvin.png', type: 'image' },
            { name: 'Badge - Hoparlor', path: 'ASSETS/badges/hoparlor.png', type: 'image' },
            
            // Sample badge files
            { name: 'Badge 1', path: 'ASSETS/badges/rozet1.png', type: 'image' },
            { name: 'Badge 42', path: 'ASSETS/badges/rozet42.png', type: 'image' },
            { name: 'Special Badge - Hira', path: 'ASSETS/badges/hira-magarasi.png', type: 'image' },
            
            // Data files
            { name: 'Kelime Data', path: 'data/kelimebul.json', type: 'json' },
            { name: 'Ayet Data', path: 'data/ayetoku.json', type: 'json' },
            { name: 'Dua Data', path: 'data/duaet.json', type: 'json' },
            { name: 'Hadis Data', path: 'data/hadisoku.json', type: 'json' },
            { name: 'Harf Data', path: 'data/harf.json', type: 'json' },
        ];

        async function checkResource(resource) {
            try {
                const response = await fetch(resource.path, { method: 'HEAD', cache: 'no-cache' });
                return {
                    success: response.ok,
                    status: response.status,
                    statusText: response.statusText
                };
            } catch (error) {
                return {
                    success: false,
                    status: 0,
                    statusText: error.message
                };
            }
        }

        async function runDiagnostics() {
            const resultsDiv = document.getElementById('results');
            const consoleDiv = document.getElementById('console-output');
            consoleDiv.style.display = 'block';
            consoleDiv.innerHTML = '<h3>Console Output:</h3>';
            
            resultsDiv.innerHTML = '<h2>Diagnostic Results:</h2>';
            
            let successCount = 0;
            let errorCount = 0;
            let warningCount = 0;
            
            for (const resource of resourcesToCheck) {
                const result = await checkResource(resource);
                const itemDiv = document.createElement('div');
                itemDiv.className = 'check-item';
                
                if (result.success) {
                    itemDiv.classList.add('success');
                    itemDiv.innerHTML = `
                        <strong>‚úÖ ${resource.name}</strong>
                        <span class="status">OK (${result.status})</span>
                        <br><code>${resource.path}</code>
                    `;
                    successCount++;
                    consoleDiv.innerHTML += `<div style="color: #10b981;">‚úì ${resource.path} - OK</div>`;
                } else {
                    itemDiv.classList.add('error');
                    itemDiv.innerHTML = `
                        <strong>‚ùå ${resource.name}</strong>
                        <span class="status">FAILED (${result.status} - ${result.statusText})</span>
                        <br><code>${resource.path}</code>
                    `;
                    errorCount++;
                    consoleDiv.innerHTML += `<div style="color: #ef4444;">‚úó ${resource.path} - FAILED (${result.status})</div>`;
                }
                
                resultsDiv.appendChild(itemDiv);
                
                // Small delay to avoid overwhelming the server
                await new Promise(resolve => setTimeout(resolve, 50));
            }
            
            // Summary
            const summaryDiv = document.createElement('div');
            summaryDiv.className = 'check-item';
            summaryDiv.style.marginTop = '20px';
            summaryDiv.style.fontSize = '18px';
            summaryDiv.innerHTML = `
                <strong>Summary:</strong><br>
                ‚úÖ Success: ${successCount}<br>
                ‚ùå Errors: ${errorCount}<br>
                ‚ö†Ô∏è Warnings: ${warningCount}
            `;
            resultsDiv.appendChild(summaryDiv);
            
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        async function checkServiceWorker() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<h2>Service Worker Status:</h2>';
            
            if ('serviceWorker' in navigator) {
                try {
                    const registrations = await navigator.serviceWorker.getRegistrations();
                    
                    if (registrations.length === 0) {
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'check-item warning';
                        itemDiv.innerHTML = '<strong>‚ö†Ô∏è No Service Worker Registered</strong>';
                        resultsDiv.appendChild(itemDiv);
                    } else {
                        for (const registration of registrations) {
                            const itemDiv = document.createElement('div');
                            itemDiv.className = 'check-item';
                            itemDiv.innerHTML = `
                                <strong>Service Worker Found</strong><br>
                                Scope: <code>${registration.scope}</code><br>
                                Active: ${registration.active ? 'Yes' : 'No'}<br>
                                Waiting: ${registration.waiting ? 'Yes' : 'No'}<br>
                                Installing: ${registration.installing ? 'Yes' : 'No'}
                            `;
                            resultsDiv.appendChild(itemDiv);
                        }
                    }
                    
                    // Check caches
                    const cacheNames = await caches.keys();
                    if (cacheNames.length > 0) {
                        const cacheDiv = document.createElement('div');
                        cacheDiv.className = 'check-item';
                        cacheDiv.innerHTML = `
                            <strong>Cache Stores Found:</strong><br>
                            ${cacheNames.map(name => `<code>${name}</code>`).join('<br>')}
                        `;
                        resultsDiv.appendChild(cacheDiv);
                    }
                } catch (error) {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'check-item error';
                    itemDiv.innerHTML = `<strong>‚ùå Error checking Service Worker:</strong><br>${error.message}`;
                    resultsDiv.appendChild(itemDiv);
                }
            } else {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'check-item warning';
                itemDiv.innerHTML = '<strong>‚ö†Ô∏è Service Workers not supported in this browser</strong>';
                resultsDiv.appendChild(itemDiv);
            }
        }

        async function clearCache() {
            if (confirm('This will clear all caches and unregister service workers. Continue?')) {
                try {
                    // Clear all caches
                    const cacheNames = await caches.keys();
                    for (const cacheName of cacheNames) {
                        await caches.delete(cacheName);
                    }
                    
                    // Unregister all service workers
                    if ('serviceWorker' in navigator) {
                        const registrations = await navigator.serviceWorker.getRegistrations();
                        for (const registration of registrations) {
                            await registration.unregister();
                        }
                    }
                    
                    // Clear browser cache (if possible)
                    if ('storage' in navigator && 'estimate' in navigator.storage) {
                        await navigator.storage.clear();
                    }
                    
                    alert('All caches cleared! Please reload the page.');
                    location.reload();
                } catch (error) {
                    alert('Error clearing cache: ' + error.message);
                }
            }
        }

        // Auto-run on load
        window.addEventListener('load', () => {
            console.log('404 Diagnostic Tool Loaded');
            console.log('Click "Run Full Diagnostic" to check all resources');
        });
    </script>
</body>
</html>



